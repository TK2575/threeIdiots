---
title: "2019 Masters"
author: "Tom Kain"
date: "April 11, 2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(janitor)
library(naniar)
```


```{r}
picks <- read_csv("data/picks.csv")
url <- "http://www.augusta.com/masters/leaderboard"

url %>% 
  read_html() %>% 
  html_nodes("table") %>% 
  .[[1]] %>% 
  html_table() %>% 
  as_tibble() -> leaderboard

leaderboard[3,] -> colnames(leaderboard)
leaderboard[-(1:3),] %>% 
  clean_names() %>% 
  rename(strokes = total_2) %>% 
  replace_with_na_all(condition = ~.x == "") -> leaderboard

leaderboard[is.na(leaderboard)] <- 0

left_join(leaderboard, picks, by = "name") -> leaderboard

filename <- paste0("data/leaderboard_",Sys.Date(),".csv")
leaderboard %>% write_csv(filename)
```

```{r warning=FALSE}
leaderboard_calc <- leaderboard %>% 
  mutate(total = if_else(total == "E",0,total %>% as.numeric()),
         today = if_else(today == "E",0,today %>% as.numeric()))
```

```{r}
leaderboard_calc %>% 
  filter(!is.na(player)) %>% 
  group_by(player, inverted) %>% 
  summarize(total = sum(total),
            today = sum(today)) %>% 
  arrange(inverted)

leaderboard_calc %>% 
  filter(!is.na(player)) %>% 
  arrange(inverted)
```